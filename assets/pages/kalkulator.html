<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulasi Penggambaran Graf dan Multigraf</title>
    
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="../styles/bootstrap-5.3.8-dist/css/bootstrap-grid.min.css">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="../styles/style.css">
</head>
<body>
    <!-- Navbar (Sama persis dengan home.html) -->
     <nav class="navbar navbar-expand-lg navbar-dark bg-dark shadow-sm full-width-navbar sticky-top">
        <div class="container-fluid"> <!-- Ubah ke container-fluid untuk full-width -->
            <span class="navbar-brand">SimulasiGraf</span>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
            </button>
            <div class="collapse navbar-collapse justify-content-end" id="navbarNav"> <!-- Tambah justify-content-end untuk susun ke kanan -->
                <ul class="navbar-nav">
                    <a class="nav-link active" href="/index.html">Beranda</a>
                    <a class="nav-link" href="/assets/pages/kalkulator.html">Kalkulator</a>
                    <a class="nav-link" href="/assets/pages/kontak.html">Kontak</a>
                </ul>
            </div>
        </div>
    </nav>


    <!-- Main Content -->
    <div class="container my-5">
        <h1 class="text-center mb-4">Simulasi Penggambaran Graf dan Multigraf</h1>
        
        <!-- Row untuk Input dan Graph -->
        <div class="row">
            <!-- Input Section -->
            <div class="col-lg-4 col-md-5 mb-4">
                <div class="input-section card p-4 shadow-sm">
                    <h2 class="h4 mb-3">Masukkan Graf</h2>
                    <p class="text-muted small mb-3">Masukkan sisi graf dalam format: A-B, B-C, A-C (pisahkan dengan koma). Contoh: A-B, B-C, A-C, A-A (untuk self-loop), atau A-B, A-B (untuk multiple edges).</p>
                    <textarea id="graph-input" class="form-control mb-3" rows="4" placeholder="Contoh: A-B, B-C, A-C"></textarea>
                    <div class="radio-group mb-3">
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="graph-type" id="undirected" value="undirected" checked>
                            <label class="form-check-label" for="undirected">Tak Berarah (Undirected)</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="graph-type" id="directed" value="directed">
                            <label class="form-check-label" for="directed">Berarah (Directed)</label>
                        </div>
                    </div>
                    <button id="process-btn" class="btn btn-primary w-100">Proses dan Gambar Graf</button>
                </div>
            </div>
            
            <!-- Graph Section -->
            <div class="col-lg-8 col-md-7">
                <div class="graph-section card p-4 shadow-sm">
                    <h2 class="h4 mb-3">Graf</h2>
                    <div id="graph-container" class="border rounded" style="height: 400px;"></div>
                </div>
            </div>
        </div>
        
        <!-- Info Section -->
        <div class="info-section card p-4 shadow-sm mt-4">
            <div id="graph-info">
                <p class="text-muted">Masukkan input dan klik "Proses dan Gambar Graf" untuk melihat penjelasan.</p>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Vis.js for Graph Visualization -->
    <script src="https://unpkg.com/vis-network@9.1.2/dist/vis-network.min.js"></script>
    <script>
        let network = null; // Variabel untuk menyimpan instance network

        document.getElementById('process-btn').addEventListener('click', function() {
            const input = document.getElementById('graph-input').value.trim();
            if (!input) {
                alert('Masukkan input graf terlebih dahulu!');
                return;
            }
            
            // Ambil jenis graf dari radio button
            const graphType = document.querySelector('input[name="graph-type"]:checked').value;
            const isDirected = graphType === 'directed';
            
            // Parse input: split by comma, then by dash for edges
            const edges = input.split(',').map(edge => edge.trim().split('-')).filter(e => e.length === 2);
            
            // Collect unique nodes
            const nodes = new Set();
            edges.forEach(edge => {
                nodes.add(edge[0]);
                nodes.add(edge[1]);
            });
            
            // Prepare data for vis.js
            const visNodes = Array.from(nodes).map(node => ({ id: node, label: node }));
            const visEdges = edges.map(edge => ({ from: edge[0], to: edge[1] }));
            
            // Define options berdasarkan jenis graf
            const options = {
                nodes: { shape: 'circle', size: 30 },
                edges: isDirected ? { arrows: 'to' } : {},  // Directed: panah; Undirected: tanpa panah
                physics: { enabled: true }
            };
            
            // Clear container sebelum membuat network baru
            const container = document.getElementById('graph-container');
            container.innerHTML = ''; // Hapus konten sebelumnya
            
            // Create network
            const data = { nodes: visNodes, edges: visEdges };
            network = new vis.Network(container, data, options);
            
            // Hitung dan tampilkan penjelasan graf
            const graphInfo = document.getElementById('graph-info');
            
            // Jumlah simpul dan sisi
            const numNodes = nodes.size;
            const numEdges = edges.length;
            
            // Hitung derajat simpul (untuk undirected: degree; untuk directed: in-degree dan out-degree)
            const inDegrees = {};
            const outDegrees = {};
            nodes.forEach(node => {
                inDegrees[node] = 0;
                outDegrees[node] = 0;
            });
            edges.forEach(edge => {
                outDegrees[edge[0]]++;
                inDegrees[edge[1]]++;
            });
            
            // Cek sisi ganda (multiple edges)
            const edgeCount = {};
            edges.forEach(edge => {
                const key = isDirected ? `${edge[0]}-${edge[1]}` : [edge[0], edge[1]].sort().join('-');
                edgeCount[key] = (edgeCount[key] || 0) + 1;
            });
            const multipleEdges = Object.entries(edgeCount).filter(([key, count]) => count > 1);
            const hasMultipleEdges = multipleEdges.length > 0;
            
            // Cek sisi loop (self-loops)
            const selfLoops = edges.filter(edge => edge[0] === edge[1]);
            const hasSelfLoops = selfLoops.length > 0;
            
            // Cek konektivitas (untuk undirected: connected; untuk directed: strongly connected - sederhana dengan DFS)
            const adjacencyList = {};
            nodes.forEach(node => adjacencyList[node] = []);
            edges.forEach(edge => {
                adjacencyList[edge[0]].push(edge[1]);
                if (!isDirected) adjacencyList[edge[1]].push(edge[0]);  // Untuk undirected, tambahkan balik
            });
            
            const visited = new Set();
            function dfs(node) {
                visited.add(node);
                adjacencyList[node].forEach(neighbor => {
                    if (!visited.has(neighbor)) dfs(neighbor);
                });
            }
            if (numNodes > 0) dfs(Array.from(nodes)[0]);
            const isConnected = visited.size === numNodes;
            
            // Klasifikasi: Jika ada sisi ganda atau sisi loop, maka Multigraf; jika tidak, Graf Sederhana
            let classification = '';
            if (!hasMultipleEdges && !hasSelfLoops) {
                classification = 'Graf Sederhana (Simple Graph)';
            } else {
                classification = 'Multigraf (Multigraph)';
            }
            
            // Tampilkan informasi 
            graphInfo.innerHTML = `
                <h3 class="h5 mb-3">Penjelasan Graf</h3>
                <p><strong>Jenis Graf:</strong> ${isDirected ? 'Berarah (Directed)' : 'Tak Berarah (Undirected)'}</p>
                <p><strong>Klasifikasi:</strong> ${classification}</p>
                <p><strong>Jumlah Simpul:</strong> ${numNodes}</p>
                <p><strong>Jumlah Sisi:</strong> ${numEdges}</p>
                <p><strong>Derajat Simpul:</strong></p>
                <ul class="list-unstyled">
                    ${Array.from(nodes).map(node => {
                        const inDeg = inDegrees[node];
                        const outDeg = outDegrees[node];
                        return `<li><strong>${node}:</strong> ${isDirected ? `In-degree: ${inDeg}, Out-degree: ${outDeg}` : `Degree: ${inDeg + outDeg}`}</li>`;
                    }).join('')}
                </ul>
                <p><strong>Sisi Ganda (Multiple Edges):</strong> ${hasMultipleEdges ? 'Ya' : 'Tidak'}</p>
                ${hasMultipleEdges ? `<ul class="list-unstyled">${multipleEdges.map(([key, count]) => `<li><strong>${key}:</strong> ${count} sisi</li>`).join('')}</ul>` : ''}
                <p><strong>Sisi Loop (Self-Loops):</strong> ${hasSelfLoops ? 'Ya' : 'Tidak'}</p>
                ${hasSelfLoops ? `<ul class="list-unstyled">${selfLoops.map(edge => `<li><strong>${edge[0]}-${edge[1]}</strong></li>`).join('')}</ul>` : ''}
                <p><strong>Konektivitas:</strong> ${isDirected ? (isConnected ? 'Graf strongly connected' : 'Graf tidak strongly connected') : (isConnected ? 'Graf terhubung' : 'Graf tidak terhubung')}</p>
            `;
        });
    </script>
</body>
</html>
